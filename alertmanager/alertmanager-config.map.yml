---
apiVersion: v1
kind: ConfigMap
metadata:
  name: alertmanager
  namespace: monitoring
  labels:
    app: alertmanager
data:
  alertmanager.yml: |
    global: {}
    route:
      group_by: ['alertname', 'job']
      group_wait: 30s      # how long to wait to buffer alerts of the same group before sending a notification initially
      group_interval: 1h   # how long to wait before sending an alert that has been added to a group for which there has already been a notification
      repeat_interval: 30s # how long to wait before re-sending a given alert that has already been sent in a notification
      receiver: 'low_priority_receiver' # default/fallback request handler
      routes:
      - receiver: low_priority_receiver
        match:
          severity: warning      
    receivers:
    - name: 'low_priority_receiver'
      webhook_configs:
        - send_resolved: true
          url: 'http://prometheus-msteams.monitoring.svc:2000/low_priority_channel' # request handler 1
